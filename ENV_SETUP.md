# Environment Variables Setup

This document explains how to configure the `.env` file for the PDF Process RAG system.

## Quick Start

1. Create a `.env` file in the project root:
   ```bash
   touch .env
   ```

2. Copy the template below and fill in your values

3. Save the file

## Environment Variables Template

Copy this template into your `.env` file:

```bash
# ============================================================================
# PDF Process RAG System - Environment Variables Configuration
# ============================================================================

# ----------------------------------------------------------------------------
# Elasticsearch Configuration (REQUIRED)
# ----------------------------------------------------------------------------
ELASTICSEARCH_HOST=http://localhost:9200
ELASTICSEARCH_USER=elastic
ELASTICSEARCH_PASSWORD=your_elasticsearch_password_here
ELASTICSEARCH_API_KEY=your_elasticsearch_api_key_here
ELASTICSEARCH_VERIFY_CERTS=false
ELASTICSEARCH_INDEX_NAME=pdf_rag_index

# ----------------------------------------------------------------------------
# Embedding API Configuration (REQUIRED)
# ----------------------------------------------------------------------------
EMBEDDING_URL=your_embedding_url

# ----------------------------------------------------------------------------
# Re-ranking API Configuration (REQUIRED)
# ----------------------------------------------------------------------------
RERANK_URL=your_rerank_url

# ----------------------------------------------------------------------------
# LLM Configuration (OPTIONAL - for answer generation)
# ----------------------------------------------------------------------------
LLM_API_URL=https://api.openai.com/v1/chat/completions
LLM_API_KEY=your_llm_api_key_here
LLM_MODEL=gpt-4o-mini
```

## Detailed Configuration

### Elasticsearch Configuration (REQUIRED)

These settings are required for the system to index and retrieve documents.

#### ELASTICSEARCH_HOST
- **Description**: Elasticsearch connection URL
- **Format**: `http://localhost:9200` or `https://localhost:9200`
- **Default**: `http://localhost:9200`
- **How to get**: From your Elasticsearch deployment
  - HTTP (default): `http://localhost:9200`
  - HTTPS: `https://localhost:9200`

#### ELASTICSEARCH_USER
- **Description**: Elasticsearch username
- **Default**: `elastic`
- **How to get**: From Elasticsearch quickstart `.env` file

#### ELASTICSEARCH_PASSWORD
- **Description**: Elasticsearch password
- **Required**: Yes
- **How to get**: 
  1. Run Elasticsearch quickstart script
  2. Find `.env` file generated by the script
  3. Copy the `ELASTIC_PASSWORD` value
  4. Paste it as `ELASTICSEARCH_PASSWORD` in your `.env` file

#### ELASTICSEARCH_API_KEY
- **Description**: Elasticsearch API key for authentication
- **Required**: Yes
- **How to get**: 
  1. From Elasticsearch quickstart `.env` file
  2. Copy the `ELASTIC_API_KEY` value
  3. Paste it as `ELASTICSEARCH_API_KEY` in your `.env` file

#### ELASTICSEARCH_VERIFY_CERTS
- **Description**: Whether to verify SSL certificates
- **Values**: `true` or `false`
- **Default**: `false`
- **When to use `true`**: If using HTTPS with valid certificates
- **When to use `false`**: If using HTTP or HTTPS with self-signed certificates (development)

#### ELASTICSEARCH_INDEX_NAME
- **Description**: Name of the Elasticsearch index
- **Default**: `pdf_rag_index`
- **Note**: Index is automatically created on first use

### Embedding API Configuration (REQUIRED)

#### EMBEDDING_URL
- **Description**: API endpoint for generating text embeddings
- **Required**: Yes
- **Default**: ``
- **Model**: qwen3-embedding-0.6b (1024 dimensions)
- **Note**: The system uses this API to generate vector embeddings for text chunks

### Re-ranking API Configuration (REQUIRED)

#### RERANK_URL
- **Description**: API endpoint for re-ranking search results
- **Required**: Yes
- **Default**: ``
- **Model**: qwen3-reranker-0.6b
- **Note**: The system uses this API to re-rank retrieved documents. Falls back to RRF if API fails.

### LLM Configuration (OPTIONAL)

These settings are optional. If not provided, the system will use a simple template-based answer generator.

#### LLM_API_URL
- **Description**: LLM API endpoint URL
- **Required**: No (optional)
- **Examples**:
  - OpenAI: `https://api.openai.com/v1/chat/completions`
  - Anthropic: `https://api.anthropic.com/v1/messages`
- **Default**: Empty (uses simple answer generator)

#### LLM_API_KEY
- **Description**: API key for LLM service
- **Required**: No (optional, only if using LLM API)
- **How to get**:
  - OpenAI: Get from https://platform.openai.com/api-keys
  - Anthropic: Get from https://console.anthropic.com/settings/keys
- **Default**: Empty

#### LLM_MODEL
- **Description**: Model name to use for answer generation
- **Required**: No (optional, only if using LLM API)
- **Examples**:
  - OpenAI: `gpt-4o-mini`, `gpt-4o`, `gpt-3.5-turbo`
  - Anthropic: `claude-3-sonnet-20240229`, `claude-3-opus-20240229`
- **Default**: `gpt-4o-mini`

## Getting Elasticsearch Credentials

1. **Run Elasticsearch Quickstart**:
   ```bash
   # Follow Elasticsearch quickstart guide
   # This will generate a .env file with credentials
   ```

2. **Find the generated `.env` file**:
   - Usually in the Elasticsearch installation directory
   - Contains credentials like `ELASTIC_PASSWORD` and `ELASTIC_API_KEY`

3. **Copy values to your project `.env`**:
   ```bash
   # From Elasticsearch .env:
   ELASTIC_PASSWORD=xxxxx
   ELASTIC_API_KEY=xxxxx
   
   # To your project .env:
   ELASTICSEARCH_PASSWORD=xxxxx
   ELASTICSEARCH_API_KEY=xxxxx
   ```

## Validation

After setting up your `.env` file, test the configuration:

```bash
# Test Elasticsearch connection
python main.py test

# If successful, you should see: "âœ“ Connection successful!"
```

## Troubleshooting

### Common Issues

1. **"Connection refused" error**:
   - Check if Elasticsearch is running: `curl http://localhost:9200`
   - Verify `ELASTICSEARCH_HOST` is correct

2. **"Authentication failed" error**:
   - Verify `ELASTICSEARCH_PASSWORD` and `ELASTICSEARCH_API_KEY` are correct
   - Check if credentials match the Elasticsearch quickstart `.env` file

3. **"SSL/TLS error"**:
   - If using HTTP, ensure `ELASTICSEARCH_HOST` starts with `http://`
   - If using HTTPS, set `ELASTICSEARCH_VERIFY_CERTS=false` for self-signed certificates

4. **"Embedding API error"**:
   - Verify `EMBEDDING_URL` is accessible
   - Check network connectivity

5. **"LLM API error"**:
   - Verify `LLM_API_KEY` is correct
   - Check if model name is valid for your API provider
   - System will fall back to simple answer generator if LLM fails

## Security Notes

- **Never commit `.env` file to Git** (it's already in `.gitignore`)
- Keep your API keys secure
- Use environment-specific `.env` files for different deployments
- Rotate API keys regularly

